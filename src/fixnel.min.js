(function(x,o,E){function i(a,b){return function(){a.apply(b,arguments)}}function k(){}function m(a){for(var b=Array.prototype.slice.call(arguments,1),c=b.length,d=0,e,r;d<c;d++)for(r in e=b[d],e)a[r]=b[d][r];return a}function h(){this.init.apply(this,arguments)}function y(){this.init.apply(this,arguments)}function z(){this.init.apply(this,arguments)}function l(a){this.init.apply(this,arguments)}function n(a,b){this.init.apply(this,arguments)}function s(a){this.init.apply(this,arguments)}function t(a){this.init.apply(this,
arguments)}var u="ontouchstart"in window,p=u?"touchstart":"mousedown",A=u?"touchmove":"mousemove",B=u?"touchend":"mouseup",C=Math.abs,f=Math.pow,q=Math.sqrt,F=Math.sin,D=Math.cos,v=Math.PI;k.prototype=function(){function a(a,b){if(!a)throw"INVALID EVENT TYPE "+a;var c=this.handlers||(this.handlers={}),g=[].concat(c[a]||[]),f=b||{},h,j,i;f.type||(f.type=a);for(j=0,h=g.length;j<h;++j)(i=g[j][0])&&i.call(g[j][1]||this,this,f);g=c["*"]||[];for(j=0,h=g.length;j<h;++j)(i=g[j][0])&&i.call(g[j][1]||this,
this,f)}function b(a,b,c){if(!a)throw"addEventListener:INVALID EVENT TYPE "+a+" "+b;var g=this.handlers||(this.handlers={});(g[a]||(g[a]=[])).push([b,c])}function c(a,b){if(!a)throw"removeEventListener:INVALID EVENT TYPE "+a+" "+fn;for(var c=(this.handlers||(this.handlers={}))[a]||[],g=c.length;g;)c[--g][0]===b&&c.splice(g,1)}return{dispatchEvent:a,trigger:a,pub:a,addEventListener:b,bind:b,sub:b,on:b,removeEventListener:c,unbind:c,off:c,one:function(a,b,c){function g(){f.removeEventListener(a,g,c);
b.apply(c||f,arguments)}var f=this;this.addEventListener(a,g,c)}}}();h.mode={NOT_FADE:0,FADE_OUT:1,FADE_IN:2,WAIT:3};h.DEFAULT_DURATION=10;h.DEFAULT_EASING="easeOutQuad";h.DEFAULT_DELAY=400;h.FPS=32;h.prototype={Easing:l,init:function(a){this.scbar=a;this.target=a.getEl();this.fadeState=h.mode.NOT_FADE},fadeIn:function(){this._clearTimer();if(this._fadeCheck(1))return false;this._fade(0,1,1)},fadeOut:function(){this._clearTimer();if(this._fadeCheck(0))return false;this._fade(1,0)},_fadeCheck:function(a){return+this._getOpacity()===
a},_clearTimer:function(){clearTimeout(this.waitTimer);clearTimeout(this.fadeTimer)},_fade:function(a,b,c){var d=this,e=a,f=0,c=c||h.DEFAULT_DURATION,g=this.easing,i=h.FPS;g&&(e=g.getValue()||a);this.easing=g=new this.Easing(h.DEFAULT_EASING,0,e,b-e,c);clearTimeout(this.fadeTimer);(function j(){var a=g.getValue();if(a===null)return d.easing=null,clearTimeout(d.fadeTimer),d.fadeTimer=null,d._setOpacity(b),d._fadeEnd(),false;d._setOpacity(a);d.fadeTimer=setTimeout(j,i)})()},_fadeEnd:function(){this.fadeState=
h.mode.NOT_FADE},delayFadeOut:function(a){var b=this;a||(a=h.DEFAULT_DELAY);clearTimeout(this.waitTimer);this.waitTimer=setTimeout(function(){b.waitTimer=null;if(b._getOpacity()===0)return false;b.fadeOut()},a)},_getOpacity:function(){return this.target.style.opacity},_setOpacity:function(a){if(!a)return false;this.target.style.opacity=a}};y.prototype=m({},k.prototype,{FPS:1E3/60,DURATION:30,Easing:l,init:function(a){this.fl=a;this._createElement();this._getContentInfo();this._setInitSize();this._fader=
new h(this);this.fl.on("update",this._update,this);this.fl.on("move",this._move,this);this.fl.on("movestart",this._moveStart,this);this.fl.on("moveend",this._moveEnd,this);this.render()},render:function(){this.container.appendChild(this.el);this._renderShow();return this},_renderShow:function(){this._show();this._wait(2E3)},getEl:function(){return this.el},_getContentInfo:function(){this.width=+(this.el.style.width||"").replace("px","");this.container=this.fl.getContainer();this.contentHeight=this.fl.getHeight();
this.containerHeight=this.fl.getParentHeight();this.scrollHeight=this.contentHeight-this.containerHeight;this.ratio=this.containerHeight/this.contentHeight},_setPos:function(a){if(!a)return false;this._pos=a;this.el.style.webkitTransform="translate3d(0, "+-(a*this.ratio|0)+"px, 0)"},_setSize:function(a){if(!a)return false;if(a<this.width)a=this.width;this.inner.style.height=a+"px"},_setInitSize:function(){var a=this.containerHeight*this.ratio|0;if(!a)return false;if(a<this.width)a=this.width;this.size=
a;this.el.style.height=a+"px";this.inner.style.height=a+"px"},_setSizeStart:function(a){a=(this.containerHeight*this.ratio|0)-a/2;this._setPosOriginStart();this._setPos(0);this._setSize(a)},_setSizeEnd:function(a){a=(this.containerHeight*this.ratio|0)+(a+this.scrollHeight)/2;this._setPosOriginEnd();this._setPos(-this.scrollHeight);this._setSize(a)},_setPosOriginStart:function(){this.inner.style.top=0;this.inner.style.bottom="auto"},_setPosOriginEnd:function(){this.inner.style.top="auto";this.inner.style.bottom=
0},_move:function(a,b){var c=b.value;if(c>0)this._setSizeStart(c);else if(c<-this.scrollHeight)this._setSizeEnd(c);else if(c===null)return this.trigger("moveend"),false;else this._setPos(c)},_moveStart:function(){clearTimeout(this.timer);if(this.moving||this.timer)return false;this.timer=null;this.moving=true;this._show()},_moveEnd:function(){this._wait(300);this.moving=false},_wait:function(a){this._fader.delayFadeOut(a)},_hide:function(){this._fader.fadeOut()},_show:function(){this._fader.fadeIn()},
_createElement:function(){var a=document.createElement("span"),b=document.createElement("span");a.className="fixnel-scrollbar";a.style.cssText="opacity: 0;position: absolute;right: 1px;top: 0;width: 6px;";b.className="fixnel-scrollbar-inner";b.style.cssText="position: absolute;left: 0;top: 0;width: 100%;background-color: rgba(0, 0, 0, 0.5);border-color: rgba(255, 255, 255, 0.3);border-radius: 3px;";a.appendChild(b);this.el=a;this.inner=b},_update:function(){this._getContentInfo();this._setInitSize();
this._setPos(this._pos);this._renderShow()}});z.prototype=m({},k.prototype,{FPS:1E3/60,DURATION:30,Easing:l,init:function(a){this.fl=a;this._createElement();this._getContentInfo();this._setInitSize();this._fader=new h(this);this.fl.on("update",this._update,this);this.fl.on("move",this._move,this);this.fl.on("movestart",this._moveStart,this);this.fl.on("moveend",this._moveEnd,this);this.render()},render:function(){this.container.appendChild(this.el);this._renderShow();return this},_renderShow:function(){this._show();
this._wait(2E3)},getEl:function(){return this.el},_getContentInfo:function(){this.width=+(this.el.style.height||"").replace("px","");this.container=this.fl.getContainer();this.contentWidth=this.fl.getWidth();this.containerWidth=this.fl.getParentWidth();this.scrollWidth=this.contentWidth-this.containerWidth;this.ratio=this.containerWidth/this.contentWidth},_setPos:function(a){if(!a)return false;this._pos=a;this.el.style.webkitTransform="translate3d("+-(a*this.ratio|0)+"px, 0, 0)"},_setSize:function(a){if(!a)return false;
if(a<this.width)a=this.width;this.inner.style.width=a+"px"},_setInitSize:function(){var a=this.containerWidth*this.ratio|0;if(!a)return false;if(a<this.width)a=this.width;this.size=a;this.el.style.width=a+"px";this.inner.style.width=a+"px"},_setSizeStart:function(a){a=(this.containerWidth*this.ratio|0)-a/2;this._setPosOriginStart();this._setPos(0);this._setSize(a)},_setSizeEnd:function(a){a=(this.containerWidth*this.ratio|0)+(a+this.scrollWidth)/2;this._setPosOriginEnd();this._setPos(-this.scrollWidth);
this._setSize(a)},_setPosOriginStart:function(){this.inner.style.left=0;this.inner.style.right="auto"},_setPosOriginEnd:function(){this.inner.style.left="auto";this.inner.style.right=0},_move:function(a,b){var c=b.value;if(c>0)this._setSizeStart(c);else if(c<-this.scrollWidth)this._setSizeEnd(c);else if(c===null)return this.trigger("moveend"),false;else this._setPos(c)},_moveStart:function(){clearTimeout(this.timer);if(this.moving||this.timer)return false;this.timer=null;this.moving=true;this._show()},
_moveEnd:function(){this._wait(300);this.moving=false},_wait:function(a){this._fader.delayFadeOut(a)},_hide:function(){this._fader.fadeOut()},_show:function(){this._fader.fadeIn()},_createElement:function(){var a=document.createElement("span"),b=document.createElement("span");a.className="fixnel-scrollbar";a.style.cssText="opacity: 0;position: absolute;bottom: 1px;left: 0;height: 6px;";b.className="fixnel-scrollbar-inner";b.style.cssText="position: absolute;left: 0;top: 0;height: 100%;background-color: rgba(0, 0, 0, 0.5);border-color: rgba(255, 255, 255, 0.3);border-radius: 3px;";
a.appendChild(b);this.el=a;this.inner=b},_update:function(){this._getContentInfo();this._setInitSize();this._setPos(this._pos);this._renderShow()}});l.prototype={init:function(a,b,c,d,e){this.timingFunction=this.easing[a||"easeInQuad"];this.t=b;this.b=c;this.c=d;this.d=e},easing:{easeInCubic:function(a,b,c,d){return c*f(a/d,3)+b},easeOutCubic:function(a,b,c,d){return c*(f(a/d-1,3)+1)+b},easeInOutCubic:function(a,b,c,d){return(a/=d/2)<1?c/2*f(a,3)+b:c/2*(f(a-2,3)+2)+b},easeInQuart:function(a,b,c,d){return c*
f(a/d,4)+b},easeOutQuart:function(a,b,c,d){return-c*(f(a/d-1,4)-1)+b},easeInOutQuart:function(a,b,c,d){return(a/=d/2)<1?c/2*f(a,4)+b:-c/2*(f(a-2,4)-2)+b},easeInQuint:function(a,b,c,d){return c*f(a/d,5)+b},easeOutQuint:function(a,b,c,d){return c*(f(a/d-1,5)+1)+b},easeInOutQuint:function(a,b,c,d){return(a/=d/2)<1?c/2*f(a,5)+b:c/2*(f(a-2,5)+2)+b},easeInSine:function(a,b,c,d){return c*(1-D(a/d*(v/2)))+b},easeOutSine:function(a,b,c,d){return c*F(a/d*(v/2))+b},easeInOutSine:function(a,b,c,d){return c/2*
(1-D(v*a/d))+b},easeInExpo:function(a,b,c,d){return c*f(2,10*(a/d-1))+b},easeOutExpo:function(a,b,c,d){return c*(-f(2,-10*a/d)+1)+b},easeInOutExpo:function(a,b,c,d){return(a/=d/2)<1?c/2*f(2,10*(a-1))+b:c/2*(-f(2,-10*--a)+2)+b},easeInCirc:function(a,b,c,d){return c*(1-q(1-(a/=d)*a))+b},easeOutCirc:function(a,b,c,d){return c*q(1-(a=a/d-1)*a)+b},easeInOutCirc:function(a,b,c,d){return(a/=d/2)<1?c/2*(1-q(1-a*a))+b:c/2*(q(1-(a-=2)*a)+1)+b},easeInQuad:function(a,b,c,d){return c*(a/=d)*a+b},easeOutQuad:function(a,
b,c,d){return-c*(a/=d)*(a-2)+b},easeInOutQuad:function(a,b,c,d){return(a/=d/2)<1?c/2*a*a+b:-c/2*(--a*(a-2)-1)+b}},getValue:function(){return this.t>this.d?null:this.timingFunction(this.t++,this.b,this.c,this.d)}};n.directionType={VERTICAL:"vertical",HORIZONTAL:"horizontal",BOTH:"both"};n.prototype=m({},k.prototype,{_setEvents:function(){this._vfixnel&&(this._vfixnel.on("move",this._moveY,this),this._vfixnel.on("moveend",this._moveEndY,this));this._hfixnel&&(this._hfixnel.on("move",this._moveX,this),
this._hfixnel.on("moveend",this._moveEndX,this))},_moveX:function(a,b){this.trigger("moveX",b)},_moveY:function(a,b){this.trigger("moveY",b)},_moveEndX:function(){this.trigger("moveendx")},_moveEndY:function(){this.trigger("moveendy")},init:function(a,b){b||(b={});b.direction===n.directionType.BOTH?(this._vfixnel=new s(a),this._hfixnel=new t(a)):b.direction===n.directionType.HORIZONTAL?this._hfixnel=new t(a):this._vfixnel=new s(a);this._setEvents()},moveTo:function(a,b,c){this._vfixnel&&this._vfixnel.moveTo(b,
c);this._hfixnel&&this._hfixnel.moveTo(a,c)},update:function(){this._vfixnel&&this._vfixnel.update();this._hfixnel&&this._hfixnel.update()}});s.prototype=m({},k.prototype,{dragging:false,DURATION:30,FPS:1E3/60,prevAccY:0,prevY:0,prevT:0,accY:0,vy:0,y:0,init:function(a){this.el=a;this.parentEl=a.parentNode;this.Easing=l;this.el.originalHeight=this.getHeight();this._initSettings();this._checkHeight();this.scrollbar=new y(this);a.className+=a.className?" fixnel-body":"fixnel-body";a.addEventListener(p,
i(this._down,this),false);a.addEventListener(p,i(this._stop,this),false);o.addEventListener(B,i(this._up,this),false);o.addEventListener(A,i(this._move,this),false);x.addEventListener("resize",i(this.update,this),false)},moveTo:function(a,b){var c=this,d,e,f;b||(b={});if(a===0||a){a*=-1;if(a>0)a=0;else if(a<(d=-this._getBottom()))a=d;if(b.animOff)return this._setY(a),false;d=this._getY();e=new this.Easing("easeOutExpo",0,d,a-d,10);this._autoMoving=true;(function w(){var b=e.getValue();if(b===null)return e=
null,clearTimeout(f),c._setY(a),c._autoMoving=false,null;c._setY(b);f=setTimeout(w,16)})()}},getValue:function(){var a,b,c=0,d=0,d=this.DURATION,e=this.vy;a=0;if(this.bouncing)return a=this.bounce.getValue(),a===null?null:a|0;a=this._getY();if(C(e)<=0)if(a>0)c=a|0,this.bounce=new this.Easing("easeOutExpo",0,c,0-c,d),this.bouncing=true;else if(a<(b=-this._getBottom()))c=a|0,this.bounce=new this.Easing("easeOutExpo",0,c,b-c,d),this.bouncing=true;else return null;if(a+e>0)this.vy=e>10?10:e;if(a-e<-this._getBottom())this.vy=
e<-10?-10:e;return a=a+this.getVY()|0},_initSettings:function(){this.el.style.webkitTextSizeAdjust="none";this.el.style.textSizeAdjust="none"},_checkHeight:function(){var a=this.getParentHeight();this.getOriginalHeight()<a?this._setHeight(a):this._setHeight("auto")},_checkOverflow:function(){-this._getBottom()>this._getY()&&this._setY(-(this.getHeight()-this.getParentHeight()))},_scrolling:function(){var a=this;a.moving=true;clearInterval(a.timer);a.timer=setInterval(function(){var b=a.getValue();
if(b===null)return a._stopScrolling(),false;a._setY(b)},this.FPS)},_stopScrolling:function(){this.vy=0;clearInterval(this.timer);this.bouncing=this.moving=false;this.bounce=null;this.trigger("moveend")},_stop:function(){var a=this;this.stopTimer=setTimeout(function(){clearInterval(a.timer);a.timer=null},100)},_getBottom:function(){return this.getHeight()-this.getParentHeight()},getVY:function(){var a=this.vy;this.vy=this.vy-this.vy/30<<0;return a},_setHeight:function(a){if(a){if(Object.prototype.toString.call(a)===
"[object String]"){this.el.style.height=a;return}}else return false;this.el.style.height=a+"px"},_getY:function(){return this.y},_setY:function(a){var b=(new WebKitCSSMatrix(this.el.style.webkitTransform)).e;this.y=a;this.el.style.webkitTransform="translate3d("+b+"px, "+a+"px, 0)";this.trigger("move",{value:a})},getContainer:function(){return this.parentEl},getHeight:function(){return this.el.clientHeight},getOriginalHeight:function(){this.getHeight();var a;this.el.style.height="auto";if(this.el.originalHeight!==
(a=this.getHeight()))this.el.originalHeight=a;return this.el.originalHeight},getParentHeight:function(){return this.parentEl.clientHeight},_down:function(a){if(this._autoMoving)return false;this.bouncing&&(this._getY()<0?this._setY(-this._getBottom()):this._setY(0),this._stopScrolling());this.dragging=true;this.trigger("movestart");this.prevY=a.touches?a.touches[0].pageY:a.pageY;this.prevT=+new Date},_move:function(a){a.preventDefault();if(!this.dragging)return true;clearTimeout(this.stopTimer);var b=
this._getY(),c=+new Date,d=c-this.prevT,a=a.touches?a.touches[0].pageY:a.pageY,e=this.prevY-a,f=e/(d||(d=1)),g=b-e;this.accY+=(f-this.prevAccY)/d*d;this.vy=-this.accY*d;if(g>0||g<-this._getBottom())g=b-(e/2|0);this._setY(g);this.prevT=c;this.prevY=a;this.prevAccY=f},_up:function(){if(!this.dragging)return true;this.dragging=false;this._scrolling()},update:function(){this._checkHeight();this._checkOverflow();this.trigger("update")}});t.prototype=m({},k.prototype,{dragging:false,DURATION:30,FPS:1E3/
60,prevAccX:0,prevX:0,prevT:0,accX:0,vy:0,x:0,init:function(a){this.el=a;this.parentEl=a.parentNode;this.Easing=l;this.el.originalWidth=this.getWidth();this._initSettings();this._checkWidth();this.scrollbar=new z(this);a.className+=a.className?" fixnel-body":"fixnel-body";a.addEventListener(p,i(this._down,this),false);a.addEventListener(p,i(this._stop,this),false);o.addEventListener(B,i(this._up,this),false);o.addEventListener(A,i(this._move,this),false);x.addEventListener("resize",i(this.update,
this),false)},moveTo:function(a,b){var c=this,d,e,f;b||(b={});if(a===0||a){a*=-1;if(a>0)a=0;else if(a<(d=-this._getRight()))a=d;if(b.animOff)return this._setX(a),false;d=this._getX();e=new this.Easing("easeOutExpo",0,d,a-d,10);this._autoMoving=true;(function w(){var b=e.getValue();if(b===null)return e=null,clearTimeout(f),c._setX(a),c._autoMoving=false,null;c._setX(b);f=setTimeout(w,16)})()}},getValue:function(){var a,b,c=0,d=0,d=this.DURATION,e=this.vy;a=0;if(this.bouncing)return a=this.bounce.getValue(),
a===null?null:a|0;a=this._getX();if(C(e)<=0)if(a>0)c=a|0,this.bounce=new this.Easing("easeOutExpo",0,c,0-c,d),this.bouncing=true;else if(a<(b=-this._getRight()))c=a|0,this.bounce=new this.Easing("easeOutExpo",0,c,b-c,d),this.bouncing=true;else return null;if(a+e>0)this.vy=e>10?10:e;if(a-e<-this._getRight())this.vy=e<-10?-10:e;return a=a+this.getVX()|0},_initSettings:function(){this.el.style.webkitTextSizeAdjust="none";this.el.style.textSizeAdjust="none"},_checkWidth:function(){var a=this.getParentWidth();
this.getOriginalWidth()<a?this._setWidth(a):this._setWidth("auto")},_checkOverflow:function(){-this._getRight()>this._getX()&&this._setX(-(this.getWidth()-this.getParentWidth()))},_scrolling:function(){var a=this;a.moving=true;clearInterval(a.timer);a.timer=setInterval(function(){var b=a.getValue();if(b===null)return a._stopScrolling(),false;a._setX(b)},this.FPS)},_stopScrolling:function(){this.vy=0;clearInterval(this.timer);this.bouncing=this.moving=false;this.bounce=null;this.trigger("moveend")},
_stop:function(){var a=this;this.stopTimer=setTimeout(function(){clearInterval(a.timer);a.timer=null},100)},_getRight:function(){return this.getWidth()-this.getParentWidth()},getVX:function(){var a=this.vy;this.vy=this.vy-this.vy/30<<0;return a},_setWidth:function(a){if(a){if(Object.prototype.toString.call(a)==="[object String]"){this.el.style.height=a;return}}else return false;this.el.style.height=a+"px"},_getX:function(){return this.x},_setX:function(a){var b=(new WebKitCSSMatrix(this.el.style.webkitTransform)).f;
this.x=a;this.el.style.webkitTransform="translate3d("+a+"px, "+b+"px, 0)";this.trigger("move",{value:a})},getContainer:function(){return this.parentEl},getWidth:function(){return this.el.clientWidth},getOriginalWidth:function(){this.getWidth();var a;this.el.style.width="auto";if(this.el.originalWidth!==(a=this.getWidth()))this.el.originalWidth=a;return this.el.originalWidth},getParentWidth:function(){return this.parentEl.clientWidth},_down:function(a){if(this._autoMoving)return false;this.bouncing&&
(this._getX()<0?this._setX(-this._getRight()):this._setX(0),this._stopScrolling());this.dragging=true;this.trigger("movestart");this.prevX=a.touches?a.touches[0].pageX:a.pageX;this.prevT=+new Date},_move:function(a){a.preventDefault();if(!this.dragging)return true;clearTimeout(this.stopTimer);var b=this._getX(),c=+new Date,d=c-this.prevT,a=a.touches?a.touches[0].pageX:a.pageX,e=this.prevX-a,f=e/(d||(d=1)),g=b-e;this.accX+=(f-this.prevAccX)/d*d;this.vy=-this.accX*d;if(g>0||g<-this._getRight())g=b-
(e/2|0);this._setX(g);this.prevT=c;this.prevX=a;this.prevAccX=f},_up:function(){if(!this.dragging)return true;this.dragging=false;this._scrolling()},update:function(){this._checkWidth();this._checkOverflow();this.trigger("update")}});E.Fixnel=n})(this,document,this);
