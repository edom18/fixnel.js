(function(B,u,C){function i(a,b){return function(){a.apply(b,arguments)}}function v(a){function b(){}var c=this,d=function(){c.apply(this,arguments)};b.prototype=c.prototype;d.prototype=new b;d.prototype.callParent=function(){c.apply(this,arguments)};d.prototype.super_=c.prototype;k(d.prototype,a);return d}function k(a){for(var b=Array.prototype.slice.call(arguments,1),c=b.length,d=0,w,l;d<c;d++)for(l in w=b[d],w)a[l]=b[d][l];return a}function m(){}function g(){this.init.apply(this,arguments)}function n(a){this.init.apply(this,
arguments)}function o(a){this.init.apply(this,arguments)}function j(a,b){this.init.apply(this,arguments)}function p(a){this.init.apply(this,arguments)}var s="ontouchstart"in window,x=s?"touchstart":"mousedown",D=s?"touchmove":"mousemove",E=s?"touchend":"mouseup",F=Math.abs,e=Math.pow,q=Math.sqrt,G=Math.sin,y=Math.cos,t=Math.PI;m.prototype=function(){function a(a,b){if(!a)throw"INVALID EVENT TYPE "+a;var c=this.handlers||(this.handlers={}),f=[].concat(c[a]||[]),e=b||{},g,h,r;e.type||(e.type=a);for(h=
0,g=f.length;h<g;++h)(r=f[h][0])&&r.call(f[h][1]||this,this,e);f=c["*"]||[];for(h=0,g=f.length;h<g;++h)(r=f[h][0])&&r.call(f[h][1]||this,this,e)}function b(a,b,c){if(!a)throw"addEventListener:INVALID EVENT TYPE "+a+" "+b;var f=this.handlers||(this.handlers={});(f[a]||(f[a]=[])).push([b,c])}function c(a,b){if(!a)throw"removeEventListener:INVALID EVENT TYPE "+a+" "+fn;for(var c=(this.handlers||(this.handlers={}))[a]||[],f=c.length;f;)c[--f][0]===b&&c.splice(f,1)}return{dispatchEvent:a,trigger:a,pub:a,
addEventListener:b,bind:b,sub:b,on:b,removeEventListener:c,unbind:c,off:c,one:function(a,b,c){function f(){e.removeEventListener(a,f,c);b.apply(c||e,arguments)}var e=this;this.addEventListener(a,f,c)}}}();g.mode={NOT_FADE:0,FADE_OUT:1,FADE_IN:2,WAIT:3};g.DEFAULT_DURATION=10;g.DEFAULT_EASING="easeOutQuad";g.DEFAULT_DELAY=400;g.FPS=32;g.prototype={Easing:o,init:function(a){this.scbar=a;this.target=a.getEl();this.fadeState=g.mode.NOT_FADE},fadeIn:function(){this._clearTimer();if(this._fadeCheck(1))return false;
this._fade(0,1,1)},fadeOut:function(){this._clearTimer();if(this._fadeCheck(0))return false;this._fade(1,0)},_fadeCheck:function(a){return+this._getOpacity()===a},_clearTimer:function(){clearTimeout(this.waitTimer);clearTimeout(this.fadeTimer)},_fade:function(a,b,c){var d=this,e=a,l=0,c=c||g.DEFAULT_DURATION,f=this.easing,i=g.FPS;f&&(e=f.getValue()||a);this.easing=f=new this.Easing(g.DEFAULT_EASING,0,e,b-e,c);clearTimeout(this.fadeTimer);(function h(){var a=f.getValue();if(a===null)return d.easing=
null,clearTimeout(d.fadeTimer),d.fadeTimer=null,d._setOpacity(b),d._fadeEnd(),false;d._setOpacity(a);d.fadeTimer=setTimeout(h,i)})()},_fadeEnd:function(){this.fadeState=g.mode.NOT_FADE},delayFadeOut:function(a){var b=this;a||(a=g.DEFAULT_DELAY);clearTimeout(this.waitTimer);this.waitTimer=setTimeout(function(){b.waitTimer=null;if(b._getOpacity()===0)return false;b.fadeOut()},a)},_getOpacity:function(){return this.target.style.opacity},_setOpacity:function(a){if(!a)return false;this.target.style.opacity=
a}};n.extend=v;n.prototype=k({},m.prototype,{FPS:1E3/60,DURATION:30,Easing:o,init:function(a){this.fl=a;this._createElement();this._getContentInfo();this._setInitSize();this._fader=new g(this);this.fl.on("update",this._update,this);this.fl.on("move",this._move,this);this.fl.on("movestart",this._moveStart,this);this.fl.on("moveend",this._moveEnd,this);this.render()},render:function(){this.container.appendChild(this.el);this._renderShow();return this},_renderShow:function(){this._show();this._wait(2E3)},
getEl:function(){return this.el},_getContentInfo:function(){this._minSize=this._getMinSize();this.container=this.fl.getContainer();this.contentSize=this.fl.getSize();this.containerSize=this.fl.getParentSize();this.scrollSize=this.contentSize-this.containerSize;this.ratio=this.containerSize/this.contentSize},_getMinSize:function(){throw Error("MUST BE IMPLEMENTS THIS METHOD");},_setPos:function(){throw Error("MUST BE IMPLEMENTS THIS METHOD");},_setSize:function(){throw Error("MUST BE IMPLEMENTS THIS METHOD");
},_setElSize:function(){throw Error("MUST BE IMPLEMENTS THIS METHOD");},_setInitSize:function(){var a=this.containerSize*this.ratio|0;if(!a)return false;if(a<this._minSize)a=this._minSize;this.size=a;this._setSize(a);this._setElSize(a)},_setSizeStart:function(a){a=(this.containerSize*this.ratio|0)-a/2;this._setPosOriginStart();this._setPos(0);this._setSize(a)},_setSizeEnd:function(a){a=(this.containerSize*this.ratio|0)+(a+this.scrollSize)/2;this._setPosOriginEnd();this._setPos(-this.scrollSize);this._setSize(a)},
_setPosOriginStart:function(){throw Error("MUST BE IMPLEMENTS THIS METHOD");},_setPosOriginEnd:function(){throw Error("MUST BE IMPLEMENTS THIS METHOD");},_move:function(a,b){var c=b.value;if(c>0)this._setSizeStart(c);else if(c<-this.scrollSize)this._setSizeEnd(c);else if(c===null)return this.trigger("moveend"),false;else this._setPos(c)},_moveStart:function(){clearTimeout(this.timer);if(this.moving||this.timer)return false;this.timer=null;this.moving=true;this._show()},_moveEnd:function(){this._wait(300);
this.moving=false},_wait:function(a){this._fader.delayFadeOut(a)},_hide:function(){this._fader.fadeOut()},_show:function(){this._fader.fadeIn()},_createElement:function(){throw Error("MUST BE IMPLEMENTS THIS METHOD");},_update:function(){this._getContentInfo();this._setInitSize();this._setPos(this._pos);this._renderShow()}});var I=n.extend({_getMinSize:function(){return+(this.el.style.width||"").replace("px","")},_setPos:function(a){if(!a)return false;this._pos=a;this.el.style.webkitTransform="translate3d(0, "+
-(a*this.ratio|0)+"px, 0)"},_setSize:function(a){if(!a)return false;if(a<this._minSize)a=this._minSize;this.inner.style.height=a+"px"},_setElSize:function(a){if(!a)return false;if(a<this._minSize)a=this._minSize;this.el.style.height=a+"px"},_setPosOriginStart:function(){this.inner.style.top=0;this.inner.style.bottom="auto"},_setPosOriginEnd:function(){this.inner.style.top="auto";this.inner.style.bottom=0},_createElement:function(){var a=document.createElement("span"),b=document.createElement("span");
a.className="fixnel-scrollbar";a.style.cssText="opacity: 0;position: absolute;right: 1px;top: 0;width: 6px;";b.className="fixnel-scrollbar-inner";b.style.cssText="position: absolute;left: 0;top: 0;width: 100%;background-color: rgba(0, 0, 0, 0.5);border-color: rgba(255, 255, 255, 0.3);border-radius: 3px;";a.appendChild(b);this.el=a;this.inner=b}}),J=n.extend({_getMinSize:function(){return+(this.el.style.height||"").replace("px","")},_setPos:function(a){if(!a)return false;this._pos=a;this.el.style.webkitTransform=
"translate3d("+-(a*this.ratio|0)+"px, 0, 0)"},_setSize:function(a){if(!a)return false;if(a<this._minSize)a=this._minSize;this.inner.style.width=a+"px"},_setElSize:function(a){if(!a)return false;if(a<this._minSize)a=this._minSize;this.el.style.width=a+"px"},_setPosOriginStart:function(){this.inner.style.left=0;this.inner.style.right="auto"},_setPosOriginEnd:function(){this.inner.style.left="auto";this.inner.style.right=0},_createElement:function(){var a=document.createElement("span"),b=document.createElement("span");
a.className="fixnel-scrollbar";a.style.cssText="opacity: 0;position: absolute;bottom: 1px;left: 0;height: 6px;";b.className="fixnel-scrollbar-inner";b.style.cssText="position: absolute;left: 0;top: 0;height: 100%;background-color: rgba(0, 0, 0, 0.5);border-color: rgba(255, 255, 255, 0.3);border-radius: 3px;";a.appendChild(b);this.el=a;this.inner=b}});o.prototype={init:function(a,b,c,d,e){this.timingFunction=this.easing[a||"easeInQuad"];this.t=b;this.b=c;this.c=d;this.d=e},easing:{easeInCubic:function(a,
b,c,d){return c*e(a/d,3)+b},easeOutCubic:function(a,b,c,d){return c*(e(a/d-1,3)+1)+b},easeInOutCubic:function(a,b,c,d){return(a/=d/2)<1?c/2*e(a,3)+b:c/2*(e(a-2,3)+2)+b},easeInQuart:function(a,b,c,d){return c*e(a/d,4)+b},easeOutQuart:function(a,b,c,d){return-c*(e(a/d-1,4)-1)+b},easeInOutQuart:function(a,b,c,d){return(a/=d/2)<1?c/2*e(a,4)+b:-c/2*(e(a-2,4)-2)+b},easeInQuint:function(a,b,c,d){return c*e(a/d,5)+b},easeOutQuint:function(a,b,c,d){return c*(e(a/d-1,5)+1)+b},easeInOutQuint:function(a,b,c,
d){return(a/=d/2)<1?c/2*e(a,5)+b:c/2*(e(a-2,5)+2)+b},easeInSine:function(a,b,c,d){return c*(1-y(a/d*(t/2)))+b},easeOutSine:function(a,b,c,d){return c*G(a/d*(t/2))+b},easeInOutSine:function(a,b,c,d){return c/2*(1-y(t*a/d))+b},easeInExpo:function(a,b,c,d){return c*e(2,10*(a/d-1))+b},easeOutExpo:function(a,b,c,d){return c*(-e(2,-10*a/d)+1)+b},easeInOutExpo:function(a,b,c,d){return(a/=d/2)<1?c/2*e(2,10*(a-1))+b:c/2*(-e(2,-10*--a)+2)+b},easeInCirc:function(a,b,c,d){return c*(1-q(1-(a/=d)*a))+b},easeOutCirc:function(a,
b,c,d){return c*q(1-(a=a/d-1)*a)+b},easeInOutCirc:function(a,b,c,d){return(a/=d/2)<1?c/2*(1-q(1-a*a))+b:c/2*(q(1-(a-=2)*a)+1)+b},easeInQuad:function(a,b,c,d){return c*(a/=d)*a+b},easeOutQuad:function(a,b,c,d){return-c*(a/=d)*(a-2)+b},easeInOutQuad:function(a,b,c,d){return(a/=d/2)<1?c/2*a*a+b:-c/2*(--a*(a-2)-1)+b}},getValue:function(){return this.t>this.d?null:this.timingFunction(this.t++,this.b,this.c,this.d)}};j.directionType={VERTICAL:"vertical",HORIZONTAL:"horizontal",BOTH:"both"};j.prototype=
k({},m.prototype,{_setEvents:function(){this._vfixnel&&(this._vfixnel.on("move",this._moveY,this),this._vfixnel.on("moveend",this._moveEndY,this));this._hfixnel&&(this._hfixnel.on("move",this._moveX,this),this._hfixnel.on("moveend",this._moveEndX,this))},_moveX:function(a,b){this.trigger("moveX",b)},_moveY:function(a,b){this.trigger("moveY",b)},_moveEndX:function(){this.trigger("moveendx")},_moveEndY:function(){this.trigger("moveendy")},init:function(a,b){b||(b={});b.direction===j.directionType.BOTH?
(this._vfixnel=new z(a),this._hfixnel=new A(a)):b.direction===j.directionType.HORIZONTAL?this._hfixnel=new A(a):this._vfixnel=new z(a);this._setEvents()},moveTo:function(a,b,c){this._vfixnel&&this._vfixnel.moveTo(b,c);this._hfixnel&&this._hfixnel.moveTo(a,c)},update:function(){this._vfixnel&&this._vfixnel.update();this._hfixnel&&this._hfixnel.update()}});p.extend=v;p.prototype=k({},m.prototype,{dragging:false,DURATION:30,FPS:1E3/60,prevAcc:0,prevPos:0,prevT:0,acc:0,_v:0,pos:0,init:function(a){this.el=
a;this.parentEl=a.parentNode;this.Easing=o;this.el.originalSize=this.getSize();this._initSettings();this._checkSize();this.scrollbar=this._getScrollbar();a.className+=a.className?" fixnel-body":"fixnel-body";a.addEventListener(x,i(this._down,this),false);a.addEventListener(x,i(this._stop,this),false);u.addEventListener(E,i(this._up,this),false);u.addEventListener(D,i(this._move,this),false);B.addEventListener("resize",i(this.update,this),false)},moveTo:function(a,b){var c=this,d,e,g;b||(b={});if(a===
0||a){a*=-1;if(a>0)a=0;else if(a<(d=-this._getEdge()))a=d;if(b.animOff)return this._setPos(a),false;d=this._getPos();e=new this.Easing("easeOutExpo",0,d,a-d,10);this._autoMoving=true;(function H(){var b=e.getValue();if(b===null)return e=null,clearTimeout(g),c._setPos(a),c._autoMoving=false,null;c._setPos(b);g=setTimeout(H,16)})()}},getValue:function(){var a,b,c=0,d=0,d=this.DURATION,e=this._v;a=0;if(this.bouncing)return a=this.bounce.getValue(),a===null?null:a|0;a=this._getPos();if(F(e)<=0)if(a>0)c=
a|0,this.bounce=new this.Easing("easeOutExpo",0,c,0-c,d),this.bouncing=true;else if(a<(b=-this._getEdge()))c=a|0,this.bounce=new this.Easing("easeOutExpo",0,c,b-c,d),this.bouncing=true;else return null;if(a+e>0)this._v=e>10?10:e;if(a-e<-this._getEdge())this._v=e<-10?-10:e;return a=a+this.getV()|0},_initSettings:function(){this.el.style.webkitTextSizeAdjust="none";this.el.style.textSizeAdjust="none"},_checkSize:function(){var a=this.getParentSize();this.getOriginalSize()<a?this._setSize(a):this._setSize("auto")},
_checkOverflow:function(){-this._getEdge()>this._getPos()&&this._setPos(-(this.getSize()-this.getParentSize()))},_scrolling:function(){var a=this;a.moving=true;clearInterval(a.timer);a.timer=setInterval(function(){var b=a.getValue();if(b===null)return a._stopScrolling(),false;a._setPos(b)},this.FPS)},_stopScrolling:function(){this._v=0;clearInterval(this.timer);this.bouncing=this.moving=false;this.bounce=null;this.trigger("moveend")},_stop:function(){var a=this;this.stopTimer=setTimeout(function(){clearInterval(a.timer);
a.timer=null},100)},_getScrollbar:function(){throw Error("MUST BE IMPLEMENTS THIS METHOD");},_getEdge:function(){return this.getSize()-this.getParentSize()},getV:function(){var a=this._v;this._v=this._v-this._v/30<<0;return a},_setSize:function(){throw Error("MUST BE IMPLEMENTS THIS METHOD");},_getPos:function(){return this.pos},_setPos:function(){throw Error("MUST BE IMPLEMENTS THIS METHOD");},_getEventPos:function(){throw Error("MUST BE IMPLEMENTS THIS METHOD");},getContainer:function(){return this.parentEl},
getSize:function(){throw Error("MUST BE IMPLEMENTS THIS METHOD");},getOriginalSize:function(){throw Error("MUST BE IMPLEMENTS THIS METHOD");},getParentSize:function(){throw Error("MUST BE IMPLEMENTS THIS METHOD");},_down:function(a){if(this._autoMoving)return false;this.bouncing&&(this._getPos()<0?this._setPos(-this._getEdge()):this._setPos(0),this._stopScrolling());this.dragging=true;this.trigger("movestart");this.prevPos=this._getEventPos(a);this.prevT=+new Date},_move:function(a){a.preventDefault();
if(!this.dragging)return true;clearTimeout(this.stopTimer);var b=this._getPos(),c=+new Date,d=c-this.prevT,a=this._getEventPos(a),e=this.prevPos-a,g=e/(d||(d=1)),f=b-e;this.acc+=(g-this.prevAcc)/d*d;this._v=-this.acc*d;if(f>0||f<-this._getEdge())f=b-(e/2|0);this._setPos(f);this.prevT=c;this.prevPos=a;this.prevAcc=g},_up:function(){if(!this.dragging)return true;this.dragging=false;this._scrolling()},update:function(){this._checkSize();this._checkOverflow();this.trigger("update")}});var z=p.extend({_getScrollbar:function(){return new I(this)},
_setSize:function(a){if(a){if(Object.prototype.toString.call(a)==="[object String]"){this.el.style.height=a;return}}else return false;this.el.style.height=a+"px"},_setPos:function(a){var b=(new WebKitCSSMatrix(this.el.style.webkitTransform)).e;this.pos=a;this.el.style.webkitTransform="translate3d("+b+"px, "+a+"px, 0)";this.trigger("move",{value:a})},_getEventPos:function(a){return a.touches?a.touches[0].pageY:a.pageY},getSize:function(){return this.el.clientHeight},getOriginalSize:function(){var a;
this.el.style.height="auto";if(this.el.originalSize!==(a=this.getSize()))this.el.originalSize=a;return this.el.originalSize},getParentSize:function(){return this.parentEl.clientHeight}}),A=p.extend({_getScrollbar:function(){return new J(this)},_setSize:function(a){if(a){if(Object.prototype.toString.call(a)==="[object String]"){this.el.style.width=a;return}}else return false;this.el.style.width=a+"px"},_setPos:function(a){var b=(new WebKitCSSMatrix(this.el.style.webkitTransform)).f;this.pos=a;this.el.style.webkitTransform=
"translate3d("+a+"px, "+b+"px, 0)";this.trigger("move",{value:a})},_getEventPos:function(a){return a.touches?a.touches[0].pageX:a.pageX},getSize:function(){return this.el.clientWidth},getOriginalSize:function(){var a;this.el.style.width="auto";if(this.el.originalSize!==(a=this.getSize()))this.el.originalSize=a;return this.el.originalSize},getParentSize:function(){return this.parentEl.clientWidth}});C.Fixnel=j})(this,document,this);
